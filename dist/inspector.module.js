import t from"react-dom";import e from"react-sortable-tree";import n from"react-sortable-tree-theme-minimal";import o from"react";import r from"react-draggable";var a=o.createContext(),i=function(t){function e(e){t.call(this,e),this.state={displayObject:null}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.render=function(){var t=this;return h(a.Provider,{value:{displayObject:this.state.displayObject,selectedDisplayObject:function(e){t.setState({displayObject:e})}}},this.props.children)},e}(o.Component);function s(t){return!isNaN(parseFloat(t))&&isFinite(t)}function p(t,e){var n=null;if(e.children)for(var o=0;o<e.children.length&&!n;o++){var r=e.children[o];n=r.__inspectorId===t?r:p(t,r)}return n}function l(t,e,n){var o=t.displayObject;if(/visible/.test(e))n=event.target.checked||o.visible;else if(/scale|anchor|pivot|skew/.test(e)){var r=e.split(".");o=o[r[0]],e=r[1]}o[e]=n,t.selectedDisplayObject(t.displayObject)}var c=1,u=function(t){function o(e){var n=this;t.call(this,e),this.refresh=function(){n.setState({data:n.getHierarchy(n.props.stage)})},this.onSortChange=function(t){n.setState({data:t})},this.onMoveNode=function(t){var e=t.nextParentNode,o=n.props.stage,r=p(t.node.inspectorId,o);(e?p(e.inspectorId,o):o).addChild(r)},this.onDragDrag=function(){null===n.wasShowing&&(n.wasShowing=n.state.show),n.state.show&&n.setState({show:!1})},this.onDragStop=function(){n.wasShowing&&n.setState({show:!0}),n.wasShowing=null},this.wasShowing=null,this.state={show:!1,data:this.getHierarchy(this.props.stage)}}return t&&(o.__proto__=t),(o.prototype=Object.create(t&&t.prototype)).constructor=o,o.prototype.getHierarchy=function(t){var e=this,n=[];return t.children&&t.children.forEach(function(t){t.__inspectorId||(t.__inspectorId=c++),n.push({children:e.getHierarchy(t),inspectorId:t.__inspectorId,title:h("span",null,t.name||t.toString())})}),n},o.prototype.render=function(){var t=this;return h(r,{handle:"h4",onDrag:this.onDragDrag,onStop:this.onDragStop},h("div",{className:"inspector-box",style:{left:0}},h("h4",{onDoubleClick:function(){return t.setState({show:!t.state.show})}},"Hierarchy"),h("div",{style:{display:this.state.show?"":"none"}},h("div",{style:{width:"100%",height:400,overflow:"auto"}},h(a.Consumer,null,function(o){return h(e,{className:"sortable-tree",treeData:t.state.data,onChange:t.onSortChange,generateNodeProps:function(e){var n=e.node;return{onClick:function(){var e=p(n.inspectorId,t.props.stage);o.selectedDisplayObject(e)}}},onMoveNode:t.onMoveNode,theme:n,rowHeight:24,scaffoldBlockPxWidth:12})})),h("button",{onClick:this.refresh,style:{float:"right"}},"Refresh"))))},o}(o.Component),d={},y=function(t){function e(e){var n=this;t.call(this,e),this.onKeyEvent=function(t){var e=n.context.displayObject;if(e){var o=t.key.toLowerCase();if(d[o]="keydown"===t.type,"keydown"===t.type&&d.d&&0===t.key.search(/arrow/i))t.preventDefault(),d.arrowLeft&&e.x--,d.arrowRight&&e.x--,d.arrowUp&&e.y--,d.arrowDown&&e.y++;else if("keyup"===t.type&&t.target instanceof HTMLInputElement&&/(arrowup|arrowdown)/.test(o)){t.preventDefault();var r=/arrowdown/.test(o)?-1:1,a=t.target.name,i=parseFloat(t.target.value);if(s(i)){var h=(/scale|alpha/i.test(a)?.1:1)*r;l(n.context,a,i+h)}}}},this.onWheelProperty=function(t){if(document.activeElement===t.target){var e=parseFloat(t.target.value);if(s(e)){var o=Math.sign(t.deltaY);t.ctrlKey&&(o*=10),l(n.context,t.target.name,e+o)}}},this.onChangeProperty=function(t){l(n.context,t.target.name,t.target.value)},this.state={show:!1},window.addEventListener("mousewheel",this.onWheelProperty),document.addEventListener("keydown",this.onKeyEvent),document.addEventListener("keyup",this.onKeyEvent)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.showProperties=function(t){return h("dl",null,h("dt",null,"name"),h("dd",null,h("input",{type:"text",name:"name",value:t.name||"",onChange:this.onChangeProperty})),h("dt",null,"visible"),h("dd",null,h("input",{type:"checkbox",name:"visible",checked:t.visible?"checked":"",onChange:this.onChangeProperty})),h("dt",null,"x/y/z"),h("dd",null,h("input",{type:"text",name:"x",size:"4",value:t.x,onChange:this.onChangeProperty})," &nbsp; ",h("input",{type:"text",name:"y",size:"4",value:t.y,onChange:this.onChangeProperty})," &nbsp; ",h("input",{type:"text",name:"zIndex",size:"4",value:t.zIndex,onChange:this.onChangeProperty})),h("dt",null,"scale x/y"),h("dd",null,h("input",{type:"text",name:"scale.x",size:"4",value:t.scale.x,onChange:this.onChangeProperty})," &nbsp; ",h("input",{type:"text",name:"scale.y",size:"4",value:t.scale.y,onChange:this.onChangeProperty})),t.anchor&&h(Fragment,null,h("dt",null,"anchor x/y"),h("dd",null,h("input",{type:"text",name:"anchor.x",size:"4",value:t.anchor.x,onChange:this.onChangeProperty})," &nbsp; ",h("input",{type:"text",name:"anchor.y",size:"4",value:t.anchor.y,onChange:this.onChangeProperty}))),h("dt",null,"pivot x/y"),h("dd",null,h("input",{type:"text",name:"pivot.x",size:"4",value:t.pivot.x,onChange:this.onChangeProperty})," &nbsp; ",h("input",{type:"text",name:"pivot.y",size:"4",value:t.pivot.y,onChange:this.onChangeProperty})),h("dt",null,"skew x/y"),h("dd",null,h("input",{type:"text",name:"skew.x",size:"4",value:t.skew.x,onChange:this.onChangeProperty})," &nbsp; ",h("input",{type:"text",name:"skew.y",size:"4",value:t.skew.y,onChange:this.onChangeProperty})),h("dt",null,"angle/rotation"),h("dd",null,h("input",{type:"text",name:"angle",size:"8",value:t.angle,onChange:this.onChangeProperty})," &nbsp; ",h("input",{type:"text",name:"rotation",size:"8",value:t.rotation,onChange:this.onChangeProperty})))},e.prototype.render=function(){var t=this;return h(r,{handle:"h4"},h("div",{className:"inspector-box",style:{right:0,left:null}},h("h4",{onDoubleClick:function(){return t.setState({show:!t.state.show})}},"Display Object"),h("div",{style:{display:this.state.show?"":"none"}},h(a.Consumer,null,function(e){return e&&e.displayObject?t.showProperties(e.displayObject):null}))))},e}(o.Component);y.contextType=a;var g=function(t){function e(e){t.call(this,e),this.props.pixi.Ticker.shared.add(this.update,this)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.update=function(t){},e.prototype.render=function(){return h(i,null,h(u,{stage:this.props.stage}),h(y,null))},e}(o.Component),v=function(e){void 0===e&&(e={});var n=window.PIXI;if(n||!e.pixi&&!e.PIXI||(n=e.pixi||e.PIXI),!n)throw"No PIXI?!";t.render(h(g,{pixi:n,stage:e.stage}),document.getElementById(e.inspectorId||"inspector"))};export{v as boot};
//# sourceMappingURL=inspector.module.js.map
